---

---

<div class="contact-container flex flex-col gap-1 text-left">
  <!-- TITULO -->
  <h3 class="contact-item text-lg font-normal text-blue-300">Hablemos</h3>
  <h2
    class="contact-item text-3xl md:text-4xl font-medium text-[var(--white)] text-pretty leading-none"
  >
    Contactame
  </h2>

  <div class="w-full flex flex-col md:flex-row gap-6 md:gap-4 mt-4">
    <!-- INFORMACIÓN -->
    <p class="contact-item text-[var(--white-icon)] text-lg font-normal">
      Si quieres ponerte en contacto conmigo, puedes usar el formulario que
      tienes al lado.
    </p>

    <!-- Formulario -->
    <form method="post" class="contact-item w-full flex flex-col gap-3">
      <input
        type="text"
        name="name"
        id="name"
        placeholder="Nombre"
        class="w-full rounded-lg border border-[var(--white-icon-tr)] p-2 text-[var(--white-icon)] bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-300"
        required
        minlength="6"
        maxlength="30"
        pattern="^[a-zA-Z ]+$"
      />

      <input
        type="email"
        name="email"
        id="email"
        placeholder="Correo electrónico"
        class="w-full rounded-lg border border-[var(--white-icon-tr)] p-2 text-[var(--white-icon)] bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-300"
        required
      />

      <textarea
        name="message"
        id="message"
        placeholder="Mensaje"
        rows="5"
        class="w-full rounded-lg border border-[var(--white-icon-tr)] p-2 text-[var(--white-icon)] bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-300"
        required
        minlength="6"
        maxlength="150"></textarea>

      <button
        id="btnSubmit"
        type="submit"
        class="bg-blue-300 text-white font-medium py-2 px-4 rounded-lg hover:bg-blue-400 transition-colors cursor-pointer disabled:bg-gray-300"
      >
        Enviar
      </button>
    </form>
  </div>
</div>

<script>
  import { actions } from "astro:actions";
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  document.addEventListener("DOMContentLoaded", () => {
    const isMobile = window.matchMedia("(max-width: 768px)").matches;

    gsap.registerPlugin(ScrollTrigger);

    !isMobile &&
      gsap.from(".contact-item", {
        y: () => gsap.utils.random(-20, 20),
        x: () => gsap.utils.random(50, -50),
        opacity: 0,
        duration: 1,
        ease: "bounce.out",
        scrollTrigger: {
          trigger: ".contact-container",
          start: "top 85%",
          toggleActions: "play none none reverse",
        },
        stagger: 0.2,
      });

    const form = document.querySelector("form") as HTMLFormElement;

    const btnSubmit = document.getElementById("btnSubmit") as HTMLButtonElement;

    form.addEventListener("submit", async (event) => {
      event.preventDefault();

      btnSubmit.disabled = true;

      const formData = new FormData(form);

      const { data, error } = await actions.sendContact(formData);

      // TODO: AGREGAR ALERTAS CON SWEET ALERT

      if (error) {
        btnSubmit.disabled = false;
        return;
      }

      if (data.ok) {
        btnSubmit.disabled = false;
        alert(data.message);
        form.reset();
      }
    });
  });
</script>
